### --- Dotf Alias File --- ###

### Aliases

alias ls='eza'
alias lt='eza --tree --level=2'

alias la='ls -a'
alias ll='ls -l'
alias lla='ls -la'
alias clear='clear && neofetch'

## Docker
alias dc='docker-compose'

## Dotf
alias dotf='cd $DOTF_PATH'

## Repos
alias repos='cd $HOME/repos'

## Git
alias gs='git status'
alias gl='git log --graph --abbrev-commit --decorate'
alias gch='git checkout'
alias ga='git add'
alias gpl='git pull'
alias gc='git commit'
alias gu='git checkout master && git pull && git checkout - && git merge master'
alias gbcu='git branch | grep \* | cut -c 3-200'
alias gpo='git push origin'
alias gpoc='gpo $(gbcu)'
alias gcs='git commit -S'

## Squash all commits on current branch into one against base branch.
## Usage: gsc -m "commit message" [-b base_branch]
## Default base: master
function gsc() {
  local msg=""
  local base="master"

  while [[ $# -gt 0 ]]; do
    case "$1" in
      -m) msg="$2"; shift 2 ;;
      -b) base="$2"; shift 2 ;;
      *) echo "Usage: gsc -m \"commit message\" [-b base_branch]"; return 1 ;;
    esac
  done

  if [[ -z "$msg" ]]; then
    echo "Error: commit message required. Usage: gsc -m \"message\" [-b branch]"
    return 1
  fi

  local merge_base=$(git merge-base "$base" HEAD)
  if [[ -z "$merge_base" ]]; then
    echo "Error: could not find merge-base with $base"
    return 1
  fi

  local ahead=$(git rev-list --count "$merge_base"..HEAD)
  if [[ "$ahead" -eq 0 ]]; then
    echo "No commits to squash (already at $base)"
    return 0
  fi

  # Stash if dirty
  local stashed=false
  if ! git diff --quiet || ! git diff --cached --quiet; then
    git stash
    stashed=true
  fi

  git reset --soft "$merge_base"
  git add -A
  git commit -m "$msg"

  if $stashed; then
    git stash pop
  fi

  echo "Squashed $ahead commits into: $msg"
}

## Zettelkasten
alias o='obsidian &!'
alias lq='logseq &!'
alias mm='cd $HOME/repos/megamind'

## Kubernetes.
alias k='kubectl --kubeconfig $HOME/.kube/birdper.ch.config'
alias km='kubectl --kubeconfig $HOME/.kube/birdper.ch.minikube.config'

## Minikube.
alias mk='minikube'

### Python
alias py='ipython'
alias pyinitd='find . -type d -exec touch {}/__init__.py \;'  # creates `__init__.py` in all dirs
alias python='python3'

## Spotify
alias spt='$HOME/dotf/spotify-tui/launch.sh'

### Suffix Aliases
alias -s pdf='zathura &!'
alias -s {md}=$EDITOR
alias -s py=python

### NeoVim
alias vi="nvim"
alias vim="nvim"
alias v="nvim"
alias nv="nvim"

### Tmux
alias t='tmux'
alias tpd='tmuxp load default'

### Vim
alias v2="vim"
alias vim2="vim"

### Wiki.
alias wiki="nvim $WIKI"

### Zathura
alias zath='zathura'

### Agents
# Naming convention: a<agent-type><subagent>
#   a  = prefix (agent)
#   c  = claude (agent type)
#   u  = units (subagent type)
# Example: acu = agent + claude + units
alias acu='claude --agent units-agent'

### Units (git worktree management)
# Prefix: u
alias un='unit-new'       # Create new worktree + cd into it
alias uc='unit-cd'        # fzf picker to cd into worktree
alias ur='unit-rm'        # fzf picker to remove worktree
alias ul='unit-list'      # List all worktrees
alias us='unit-sync'      # Sync current worktree with main
